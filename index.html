<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mehdyx Store — After Effects Assets</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700;900&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#031025; --card:#071426; --glass:rgba(255,255,255,0.04);
      --accent1:#6ee7b7; --accent2:#7c5cff; --muted:rgba(230,240,255,0.75);
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;
      background:radial-gradient(1000px 500px at 10% 10%, rgba(124,92,255,0.06), transparent),
                 linear-gradient(180deg,#001024 0%, #04112a 100%);
      color:#e6f0ff;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:32px}
    .wrap{max-width:1100px;width:100%}
    header{display:flex;align-items:center;gap:14px;margin-bottom:18px}
    .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,var(--accent1),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:800;color:#041;box-shadow:0 6px 30px rgba(124,92,255,0.08)}
    h1{font-size:20px;margin:0}
    p.lead{margin:2px 0 0;color:var(--muted)}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:18px;margin-top:16px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:14px;border:1px solid rgba(255,255,255,0.03);backdrop-filter:blur(8px)}
    .thumb{height:160px;border-radius:10px;overflow:hidden;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.15));display:flex;align-items:center;justify-content:center;margin-bottom:10px}
    .thumb img{width:100%;height:100%;object-fit:cover}
    h3{margin:6px 0 4px;font-size:16px}
    .meta{display:flex;justify-content:space-between;align-items:center;color:var(--muted);font-size:13px}
    .price{font-weight:800;color:var(--accent1)}
    .actions{display:flex;gap:8px;margin-top:10px}
    .btn{background:linear-gradient(90deg,var(--accent1),var(--accent2));border:none;padding:9px 12px;border-radius:10px;color:#052;cursor:pointer;font-weight:800}
    .ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--accent1);font-weight:700}
    .small{font-size:13px;color:var(--muted)}
    .prod-preview{border-radius:8px;overflow:hidden;border:1px solid rgba(255,255,255,0.03);margin-top:8px;padding:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent)}
    footer{margin-top:22px;color:var(--muted);font-size:13px;text-align:center;padding-bottom:6px}
    /* modal */
    .backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.6);display:none;align-items:center;justify-content:center;padding:20px;z-index:80}
    .modal{width:100%;max-width:820px;background:linear-gradient(180deg,#061227,#071427);border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.03)}
    .grid2{display:grid;grid-template-columns:220px 1fr;gap:14px}
    .qr{width:220px;height:220px;border-radius:10px;background:#06131b;display:flex;align-items:center;justify-content:center;font-size:13px;color:rgba(255,255,255,0.6);border:1px solid rgba(255,255,255,0.03);background-size:cover}
    input,textarea,select{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    .field{margin-top:10px}
    @media(max-width:880px){.grid{grid-template-columns:1fr}.grid2{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">MX</div>
      <div>
        <h1>Mehdyx Store</h1>
        <p class="lead">Neon liquid-glass marketplace — After Effects packs, presets & audio FX. Pay via UPI, get download by email.</p>
      </div>
    </header>

    <!-- Products Grid -->
    <div id="productsGrid" class="grid" aria-live="polite"></div>

    <footer>© Mehdyx Store — <a href="mailto:mehdyxae@gmail.com" style="color:var(--accent1)">mehdyxae@gmail.com</a></footer>
  </div>

  <!-- Purchase Modal -->
  <div id="modal" class="backdrop" onclick="if(event.target===this) closeModal()">
    <div class="modal" role="dialog" aria-modal="true">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <strong id="modalTitle">Buy — Product</strong>
        <button class="ghost" onclick="closeModal()">Close</button>
      </div>

      <div class="grid2" style="margin-top:14px">
        <div>
          <div id="modalQr" class="qr">QR</div>
          <div style="margin-top:8px" class="small">UPI ID</div>
          <div style="display:flex;gap:8px;margin-top:8px">
            <input id="modalUpi" readonly>
            <button class="btn" onclick="copyUPI()">Copy</button>
          </div>
          <div class="small" style="margin-top:8px">Amount: <strong id="modalAmount">₹10</strong></div>
        </div>

        <div>
          <div class="small">Steps:</div>
          <ol class="small" style="margin:8px 0 0;padding-left:18px;color:var(--muted)">
            <li>Scan QR or copy UPI ID and pay the amount using your UPI app.</li>
            <li>After payment, enter your Name, Gmail, and UPI Txn ID below and click <em>Confirm & Get Link</em>.</li>
            <li>The download link will be sent automatically to your Gmail.</li>
          </ol>

          <div class="field"><input id="buyerName" placeholder="Your name"></div>
          <div class="field"><input id="buyerEmail" placeholder="Your Gmail (required)"></div>
          <div class="field"><input id="buyerTxn" placeholder="UPI Transaction / UTR ID (required)"></div>

          <div style="margin-top:12px;display:flex;gap:8px">
            <button id="confirmBtn" class="btn">Confirm & Get Link</button>
            <button class="ghost" onclick="openSupport()">Contact Support</button>
          </div>
          <div id="modalMsg" style="margin-top:10px;color:var(--accent1)"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- EmailJS client -->
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

  <script>
    /***** CONFIGURE: change these if needed *****/
    const STORE_NAME = 'Mehdyx Store';
    const UPI_ID = '7705874731@ptyes';
    const EMAILJS_SERVICE_ID = 'service_g1bx5b9';
    const EMAILJS_TEMPLATE_ID = 'template_vunjt2u';
    const EMAILJS_USER_ID = 'irrR0SMkmFxdzlx-t'; // public key
    /*********************************************/

    // Products array (multi-product ready). Add more objects to add more products.
    // Each product: id (slug), title, price (INR), thumb (image URL), previewNoFX (drive id), previewFX (drive id), driveLink (delivery)
    const products = [
      {
        id: 'echo-audio-ffx',
        title: 'Echo Audio FFX Preset',
        price: 10,
        thumb: 'https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?q=80&w=1200&auto=format&fit=crop&ixlib=rb-4.0.3&s=0',
        previewNoFX: '1PWJ6nu91-7L9gsFi4vrIz_zhBHrJbvmG',
        previewFX: '1ez_-INClurpEYz6a-zXB0thBXghBBJho',
        driveLink: 'https://drive.google.com/file/d/1r6liu6ivcbhRDgj7WPHumHdbs2h48st3/view?usp=sharing',
        desc: 'One-click echo audio preset for After Effects. Includes demo audio (with/without).'
      }
      // add more products here as objects
    ];

    // init EmailJS
    (function(){
      if(window.emailjs){
        try { emailjs.init(EMAILJS_USER_ID); } catch(e){ console.warn('EmailJS init error', e); }
      }
    })();

    // helper to create direct playable drive URL
    function driveDirect(id){
      return `https://docs.google.com/uc?export=download&id=${id}`;
    }

    // render products to grid
    const grid = document.getElementById('productsGrid');
    function render(){
      grid.innerHTML = '';
      products.forEach(p=>{
        const el = document.createElement('div'); el.className='card';
        el.innerHTML = `
          <div class="thumb"><img src="${p.thumb}" alt="${p.title}"></div>
          <h3>${p.title}</h3>
          <div class="meta"><div class="price">₹${p.price}</div><div class="small">Instant preview</div></div>
          <p class="small">${p.desc}</p>
          <div class="prod-preview">
            <div class="small">Without effect</div>
            <audio controls preload="none"><source src="${driveDirect(p.previewNoFX)}" type="audio/mpeg"></audio>
            <div class="small" style="margin-top:8px">With effect</div>
            <audio controls preload="none"><source src="${driveDirect(p.previewFX)}" type="audio/mpeg"></audio>
          </div>
          <div class="actions" style="margin-top:10px">
            <button class="btn" onclick="openBuy('${p.id}')">Buy ₹${p.price}</button>
            <button class="ghost" onclick="copyProductLink('${p.id}')">Share</button>
          </div>
        `;
        grid.appendChild(el);
      });
    }

    render();

    // modal logic
    let activeProduct = null;
    const modal = document.getElementById('modal');
    const modalTitle = document.getElementById('modalTitle');
    const modalQr = document.getElementById('modalQr');
    const modalUpi = document.getElementById('modalUpi');
    const modalAmount = document.getElementById('modalAmount');
    const buyerName = document.getElementById('buyerName');
    const buyerEmail = document.getElementById('buyerEmail');
    const buyerTxn = document.getElementById('buyerTxn');
    const modalMsg = document.getElementById('modalMsg');

    function openBuy(id){
      activeProduct = products.find(x=>x.id===id);
      if(!activeProduct) return alert('Product not found');
      modalTitle.innerText = `Buy — ${activeProduct.title} (₹${activeProduct.price})`;
      modalUpi.value = UPI_ID;
      modalAmount.innerText = `₹${activeProduct.price}`;
      const qr = `https://chart.googleapis.com/chart?chs=300x300&cht=qr&chl=${encodeURIComponent('upi://pay?pa='+UPI_ID+'&pn='+STORE_NAME+'&am='+activeProduct.price+'&cu=INR&tn='+activeProduct.title)}`;
      modalQr.style.backgroundImage = `url('${qr}')`;
      modalQr.style.backgroundSize = 'cover';
      modalMsg.innerText = '';
      buyerName.value = ''; buyerEmail.value = ''; buyerTxn.value = '';
      modal.style.display = 'flex';
      window.scrollTo({top:0,behavior:'smooth'});
    }
    function closeModal(){ modal.style.display='none'; }

    function copyUPI(){ modalUpi.select(); document.execCommand('copy'); alert('UPI copied: '+modalUpi.value); }
    function copyProductLink(id){ navigator.clipboard.writeText(location.href + '#'+id).then(()=>alert('Product link copied to clipboard')) }

    function openSupport(){ window.open('https://t.me/MehdyxSupport','_blank'); }

    // Confirm & send email via EmailJS
    document.getElementById('confirmBtn').addEventListener('click', async function(){
      const name = buyerName.value.trim();
      const email = buyerEmail.value.trim();
      const txn = buyerTxn.value.trim();
      if(!email || !txn){ modalMsg.style.color='salmon'; modalMsg.innerText='Email and Txn ID required.'; return; }
      modalMsg.style.color = 'var(--accent1)'; modalMsg.innerText = 'Sending link — please wait...';

      const templateParams = {
        to_email: email,
        buyer_name: name || 'Buyer',
        product_name: activeProduct.title,
        drive_link: activeProduct.driveLink,
        txn_id: txn
      };

      try {
        if(typeof emailjs === 'undefined') throw new Error('EmailJS not loaded');
        await emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, templateParams);
        modalMsg.style.color = 'lightgreen';
        modalMsg.innerText = '✅ Link sent! Check your Gmail (may be in spam).';
        setTimeout(()=>{ closeModal(); },1500);
      } catch (err) {
        console.error('Email send failed', err);
        modalMsg.style.color = 'salmon';
        modalMsg.innerText = 'Failed to send email. Check EmailJS settings or console.';
      }
    });

    // If URL contains #productid open deep link / scroll — optional
    window.addEventListener('DOMContentLoaded', ()=>{
      const hash = location.hash.replace('#','');
      if(hash){
        const p = products.find(x=>x.id===hash);
        if(p) window.scrollTo({top: document.querySelector(`[onclick="openBuy('${p.id}')"]`).offsetTop - 80, behavior:'smooth'});
      }
    });

    // analytics (simple)
    console.log('Mehdyx Store loaded — products:', products.length);
  </script>
</body>
</html>
