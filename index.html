<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mehdyx Store — Echo Audio FFX Preset</title>
  <meta name="description" content="Mehdyx Store — After Effects audio & presets. Pay via UPI, receive Drive link by email.">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700;900&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg-top: #8b0000;   /* deep red top */
      --bg-bottom: #000000; /* black bottom */
      --glass-bg: rgba(255,255,255,0.04);
      --glass-border: rgba(255,255,255,0.08);
      --accent1: #ff6b6b;
      --accent2: #7c5cff;
      --muted: rgba(230,240,255,0.75);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Inter,system-ui,Segoe UI,Roboto,Arial;
      min-height:100vh;
      color:#eaf4ff;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:28px;
      background: linear-gradient(180deg, var(--bg-top) 0%, rgba(139,0,0,0.45) 25%, rgba(20,6,12,0.6) 60%, var(--bg-bottom) 100%);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .wrap{width:100%;max-width:1100px}

    header{display:flex;gap:14px;align-items:center;margin-bottom:18px}
    .logo{width:64px;height:64px;border-radius:14px;background:linear-gradient(135deg,var(--accent1),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:900;color:#041;box-shadow:0 12px 40px rgba(124,92,255,0.18), inset 0 -8px 24px rgba(0,0,0,0.18)}
    h1{margin:0;font-size:22px;text-transform:capitalize;letter-spacing:0.6px; color: #fff; text-shadow: 0 6px 30px rgba(124,92,255,0.12);}
    p.lead{margin:2px 0 0;color:var(--muted);font-size:13px}

    /* Card */
    .card{
      position:relative;
      border-radius:20px;
      padding:28px;
      overflow:hidden;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.03);
      backdrop-filter: blur(12px) saturate(120%);
      box-shadow: 0 10px 40px rgba(2,6,23,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
      display:flex;
      gap:26px;
      align-items:flex-start;
    }

    /* glossy liquid highlights */
    .shine {
      position:absolute;
      inset: -20% -30% auto auto;
      width: 60%;
      height: 60%;
      background: radial-gradient(closest-side, rgba(255,255,255,0.08), rgba(255,255,255,0.02) 40%, transparent 60%);
      transform: rotate(-18deg);
      filter: blur(40px);
      pointer-events:none;
      mix-blend-mode:screen;
    }
    .rim {
      position:absolute;
      inset:0;
      border-radius:20px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.03), 0 40px 80px rgba(0,0,0,0.6);
      pointer-events:none;
    }

    .left{width:360px;min-width:260px}
    .thumb{
      height:240px;
      border-radius:14px;
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
      border:1px solid rgba(255,255,255,0.04);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.12));
      box-shadow: 0 12px 30px rgba(124,92,255,0.06);
    }
    .thumb img{width:100%;height:100%;object-fit:cover;display:block}

    .title {margin-top:12px}
    .title h2{margin:0;font-size:20px; font-weight:800; letter-spacing:0.4px; color: white; text-shadow: 0 6px 18px rgba(124,92,255,0.08);}
    .title p{margin:6px 0 0;color:var(--muted);font-size:13px}

    .price{margin-top:12px;font-weight:900;color:var(--accent1);font-size:18px}

    .actions{display:flex;gap:10px;margin-top:14px}
    .btn{
      border:0;
      padding:10px 14px;
      border-radius:12px;
      font-weight:800;
      cursor:pointer;
      background: linear-gradient(90deg,var(--accent1),var(--accent2));
      color:#031018;
      box-shadow: 0 8px 24px rgba(124,92,255,0.12);
    }
    .btn.ghost{
      background:transparent;
      color:var(--accent1);
      border:1px solid rgba(255,255,255,0.06);
      font-weight:700;
    }

    .right{flex:1}
    .feature{
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));
      padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);
    }

    .preview{margin-top:12px;border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,0.03);background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));padding:12px}
    .preview .row{display:flex;gap:12px;align-items:center}
    .preview .label{font-size:13px;color:var(--muted);margin-bottom:6px}
    .audio-row{display:flex;gap:10px;align-items:center;margin-top:10px}
    .play-quick{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 10px;border-radius:10px;color:var(--muted);cursor:pointer;font-weight:700}
    .play-quick.playing{color:var(--accent1); box-shadow: 0 8px 28px rgba(255,107,107,0.12);}

    footer{margin-top:18px;color:var(--muted);font-size:13px;text-align:center;padding-bottom:8px}

    /* modal */
    .backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.6);display:none;align-items:center;justify-content:center;padding:20px;z-index:90}
    .modal{width:100%;max-width:820px;background:linear-gradient(180deg,#16060a,#0b0c10);border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.03)}

    .grid2{display:grid;grid-template-columns:240px 1fr;gap:16px}
    .qr{width:220px;height:220px;border-radius:12px;background:#06131b;display:flex;align-items:center;justify-content:center;font-size:13px;color:rgba(255,255,255,0.6);border:1px solid rgba(255,255,255,0.03);background-size:cover}
    input,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    .field{margin-top:10px}
    .muted{font-size:13px;color:var(--muted)}

    @media(max-width:880px){
      .card{flex-direction:column;padding:20px}
      .left{width:100%}
      .grid2{grid-template-columns:1fr}
      .thumb{height:180px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">MX</div>
      <div>
        <h1>Mehdyx Store</h1>
        <p class="lead">Pay via UPI — get download link by Gmail automatically.</p>
      </div>
    </header>

    <main class="card" role="main" aria-labelledby="store-title">
      <div class="shine" aria-hidden="true"></div>
      <div class="rim" aria-hidden="true"></div>

      <div class="left" aria-hidden="false">
        <div class="thumb" aria-hidden="true">
          <img src="https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?q=80&w=1400&auto=format&fit=crop&ixlib=rb-4.0.3&s=0" alt="Echo preset thumbnail">
        </div>

        <div class="title">
          <h2 id="store-title">Echo Audio FFX Preset</h2>
          <p class="muted">One-click echo audio preset for After Effects. Includes demo audio (with & without).</p>
        </div>

        <div class="price">₹10</div>

        <div class="actions" aria-hidden="false">
          <button id="buyBtn" class="btn">Buy — Pay via UPI</button>
          <button id="previewBtn" class="btn ghost">Quick Preview</button>
        </div>

        <div style="margin-top:10px;font-size:13px;color:var(--muted)">Share: <a id="copyLink" style="color:var(--accent1);cursor:pointer">Copy product link</a></div>
      </div>

      <div class="right">
        <div class="feature" role="region" aria-label="Product preview">
          <div class="preview">
            <div class="label">Demo — quick compare</div>

            <div class="audio-row">
              <div style="flex:1">
                <div class="muted">Without effect</div>
                <button class="play-quick" id="playNo">Play</button>
              </div>

              <div style="flex:1">
                <div class="muted">With echo effect</div>
                <button class="play-quick" id="playWith">Play</button>
              </div>
            </div>

            <div style="margin-top:12px">
              <div class="muted">Full preview players</div>
              <div style="margin-top:8px">
                <audio id="audioNo" controls preload="none" style="width:100%;border-radius:8px;margin-bottom:8px">
                  <source src="https://docs.google.com/uc?export=download&id=1PWJ6nu91-7L9gsFi4vrIz_zhBHrJbvmG" type="audio/mpeg">
                  Your browser doesn't support audio.
                </audio>
                <audio id="audioWith" controls preload="none" style="width:100%;border-radius:8px">
                  <source src="https://docs.google.com/uc?export=download&id=1ez_-INClurpEYz6a-zXB0thBXghBBJho" type="audio/mpeg">
                  Your browser doesn't support audio.
                </audio>
              </div>
            </div>

            <div style="margin-top:12px" class="muted">After payment you will receive the download link to your Gmail automatically. For support: <a href="https://t.me/MehdyxSupport" target="_blank" style="color:var(--accent1)">Telegram</a></div>
          </div>
        </div>
      </div>
    </main>

    <footer>© Mehdyx Store — <a href="mailto:mehdyxae@gmail.com" style="color:var(--accent1)">mehdyxae@gmail.com</a></footer>
  </div>

  <!-- Purchase Modal -->
  <div id="modal" class="backdrop" onclick="if(event.target===this) closeModal()">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <strong id="modalTitle">Pay ₹10 — Echo Audio FFX Preset</strong>
        <button class="btn ghost" onclick="closeModal()">Close</button>
      </div>

      <div class="grid2" style="margin-top:14px">
        <div>
          <div id="qrBox" class="qr" aria-hidden="true">QR</div>
          <div style="margin-top:10px" class="muted">UPI ID</div>
          <div style="display:flex;gap:8px;margin-top:8px">
            <input id="upiInput" readonly value="7705874731@ptyes" />
            <button class="btn" onclick="copyUPI()">Copy</button>
          </div>
          <div class="muted" style="margin-top:8px">Amount: <strong>₹10</strong></div>
        </div>

        <div>
          <div class="muted">Instructions:</div>
          <ol class="muted" style="margin:8px 0 0;padding-left:18px">
            <li>Scan QR or copy UPI and pay ₹10 using your UPI app.</li>
            <li>After payment, enter your Name, Gmail, and UPI Txn ID below and press <strong>Confirm & Get Link</strong>.</li>
            <li>The Drive link will be sent to your email automatically.</li>
          </ol>

          <div class="field"><input id="buyerName" placeholder="Your name"></div>
          <div class="field"><input id="buyerEmail" placeholder="Your Gmail (required)"></div>
          <div class="field"><input id="buyerTxn" placeholder="UPI Transaction / UTR ID (required)"></div>

          <div style="margin-top:12px;display:flex;gap:8px">
            <button id="confirmBtn" class="btn">Confirm & Get Link</button>
            <button class="btn ghost" onclick="openSupport()">Contact Support</button>
          </div>
          <div id="modalMsg" style="margin-top:10px;color:var(--accent1)"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- EmailJS client -->
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

  <script>
    /* ========== CONFIG ========== */
    const UPI_ID = '7705874731@ptyes';
    const EMAILJS_SERVICE_ID = 'service_g1bx5b9';
    const EMAILJS_TEMPLATE_ID = 'template_vunjt2u';
    const EMAILJS_USER_ID = 'irrR0SMkmFxdzlx-t'; // public key
    const PRODUCT = {
      id:'echo-audio-ffx',
      title:'Echo Audio FFX Preset',
      price:10,
      driveLink:'https://drive.google.com/file/d/1r6liu6ivcbhRDgj7WPHumHdbs2h48st3/view?usp=sharing'
    };
    /* ========== END CONFIG ========== */

    // Init EmailJS
    (function(){
      if(window.emailjs){
        try { emailjs.init(EMAILJS_USER_ID); } catch(e){ console.warn('EmailJS init failed', e); }
      }
    })();

    // Elements
    const buyBtn = document.getElementById('buyBtn');
    const previewBtn = document.getElementById('previewBtn');
    const copyLink = document.getElementById('copyLink');
    const modal = document.getElementById('modal');
    const qrBox = document.getElementById('qrBox');
    const upiInput = document.getElementById('upiInput');
    const confirmBtn = document.getElementById('confirmBtn');
    const modalMsg = document.getElementById('modalMsg');
    const playNo = document.getElementById('playNo');
    const playWith = document.getElementById('playWith');
    const audioNo = document.getElementById('audioNo');
    const audioWith = document.getElementById('audioWith');
    const buyerName = document.getElementById('buyerName');
    const buyerEmail = document.getElementById('buyerEmail');
    const buyerTxn = document.getElementById('buyerTxn');

    // Quick-play logic (user gesture required for autoplay)
    let noPlaying = false, withPlaying = false;
    const setPlayingState = (btn, state) => {
      if(state) btn.classList.add('playing'); else btn.classList.remove('playing');
    };

    // Ensure only one plays at a time
    function stopAllAudio(){
      try{ audioNo.pause(); audioNo.currentTime = 0; }catch(e){}
      try{ audioWith.pause(); audioWith.currentTime = 0; }catch(e){}
      setPlayingState(playNo, false);
      setPlayingState(playWith, false);
      noPlaying = withPlaying = false;
    }

    playNo.addEventListener('click', ()=>{
      // first user gesture: allow browsers to enable playback
      if(noPlaying){
        audioNo.pause(); noPlaying=false; setPlayingState(playNo,false);
      } else {
        stopAllAudio();
        audioNo.play().catch(e=>{ alert('Tap play on the audio player below if autoplay is blocked.'); });
        noPlaying=true; setPlayingState(playNo,true);
      }
    });

    playWith.addEventListener('click', ()=>{
      if(withPlaying){
        audioWith.pause(); withPlaying=false; setPlayingState(playWith,false);
      } else {
        stopAllAudio();
        audioWith.play().catch(e=>{ alert('Tap play on the audio player below if autoplay is blocked.'); });
        withPlaying=true; setPlayingState(playWith,true);
      }
    });

    // Also when the full players start, stop the quick one
    audioNo.addEventListener('play', ()=>{ stopAllAudio(); audioNo.play(); setPlayingState(playNo,true); noPlaying=true; });
    audioWith.addEventListener('play', ()=>{ stopAllAudio(); audioWith.play(); setPlayingState(playWith,true); withPlaying=true; });

    // Modal open/close and QR generation
    buyBtn.addEventListener('click', openModal);
    previewBtn.addEventListener('click', ()=>{ window.scrollTo({top:0,behavior:'smooth'}); alert('Play the quick preview buttons or the full audio players to compare.'); });
    copyLink.addEventListener('click', ()=>{ navigator.clipboard.writeText(location.href + '#'+PRODUCT.id).then(()=>alert('Product link copied to clipboard')); });

    function openModal(){
      modal.style.display = 'flex';
      upiInput.value = UPI_ID;
      const qr = 'https://chart.googleapis.com/chart?chs=320x320&cht=qr&chl=' + encodeURIComponent(`upi://pay?pa=${UPI_ID}&pn=Mehdyx Store&am=${PRODUCT.price}&cu=INR&tn=${PRODUCT.title}`);
      qrBox.style.backgroundImage = `url('${qr}')`;
      qrBox.style.backgroundSize = 'cover';
      modalMsg.innerText = '';
      buyerName.value=''; buyerEmail.value=''; buyerTxn.value='';
      window.scrollTo({top:0,behavior:'smooth'});
    }
    function closeModal(){ modal.style.display='none'; }

    function copyUPI(){ upiInput.select(); document.execCommand('copy'); alert('UPI copied: '+upiInput.value); }
    function openSupport(){ window.open('https://t.me/MehdyxSupport','_blank'); }

    // Optional: open UPI app on mobile (user must be on mobile)
    function openUPIMobile(){
      const upiDeep = `upi://pay?pa=${encodeURIComponent(UPI_ID)}&pn=${encodeURIComponent('Mehdyx Store')}&am=${encodeURIComponent(PRODUCT.price)}&cu=INR&tn=${encodeURIComponent(PRODUCT.title)}`;
      // open deep link
      window.location.href = upiDeep;
    }

    // Confirm & send email via EmailJS
    confirmBtn.addEventListener('click', async ()=>{
      const name = buyerName.value.trim();
      const email = buyerEmail.value.trim();
      const txn = buyerTxn.value.trim();
      if(!email || !txn){ modalMsg.style.color='salmon'; modalMsg.innerText = 'Email and Txn ID required.'; return; }
      modalMsg.style.color = 'var(--accent1)'; modalMsg.innerText = 'Sending link — please wait...';

      const templateParams = {
        to_email: email,
        buyer_name: name || 'Buyer',
        product_name: PRODUCT.title,
        drive_link: PRODUCT.driveLink,
        txn_id: txn
      };

      try {
        if(typeof emailjs === 'undefined') throw new Error('EmailJS not loaded');
        await emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, templateParams);
        modalMsg.style.color = 'lightgreen';
        modalMsg.innerText = '✅ Link sent! Check your Gmail (may be in spam).';
        setTimeout(()=>{ closeModal(); },1400);
      } catch (err) {
        console.error('Email send failed', err);
        modalMsg.style.color = 'salmon';
        modalMsg.innerText = 'Failed to send email. Check EmailJS settings or console.';
      }
    });

    // Accessibility: if user clicks buyBtn on mobile quickly open UPI
    buyBtn.addEventListener('dblclick', ()=>{ openUPIMobile(); });

    // small analytics log
    console.log('Mehdyx Store loaded — product:', PRODUCT.id);
  </script>
</body>
</html>
